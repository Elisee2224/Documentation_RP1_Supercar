 $updateSql = "UPDATE voitures SET marque='$marque', modele='$modele', annee='$annee', description1='$description1', description='".mysqli_real_escape_string($bdd, $description)."', prix='$nouveauPrix' WHERE idvoiture = $idvoiture";








DROP TRIGGER IF EXISTS before_update_prix;

DELIMITER //

CREATE TRIGGER before_update_prix
BEFORE UPDATE ON voitures
FOR EACH ROW
BEGIN
    DECLARE max_increase DECIMAL(10, 2);
    DECLARE current_price DECIMAL(10, 2);

    IF NEW.prix > OLD.prix THEN
        SET max_increase = OLD.prix * 0.25;
        SET current_price = NEW.prix;

        IF (current_price - OLD.prix) > max_increase THEN
            SET NEW.prix = OLD.prix + max_increase;
        END IF;
    END IF;
END//

DELIMITER ;
